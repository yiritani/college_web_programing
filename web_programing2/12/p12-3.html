<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="utf-8">
	<title>Canvasアニメーション</title>
	<style>
	canvas {border : 1px solid gray;}
</style>
</head>
<body>
	<h1>Canvasアニメーション</h1>
	<canvas width="600px" height="400px"></canvas>
	<br><button id="btn">円を描く</button>
	<button id="stopBtn">停止</button>

	<script>
      let c={x:0,y:0,r:100}
      let timerID = null;
      const cv = document.querySelector('canvas')
      const gc = cv.getContext('2d')
      const btn = document.querySelector('#btn')
      const stopBtn = document.querySelector('#stopBtn')
      const colorArray = ['red','blue','green','yellow','orange','pink']
      const circleArray = []
      btn.addEventListener('click',()=>{
        generateRandomCircle()
        if (timerID==null) {
            timerID=setInterval(moveCircles, 200);
				}
      })

      stopBtn.addEventListener('click',()=>{
        clearInterval(timerID);
        timerID=null;
      })

			function generateRandomNum(min, max) {
				return Math.floor(Math.random() * (max - min + 1)) + min;
			}
      function chooseRandomcolor() {
				return colorArray[Math.floor(Math.random() * colorArray.length)];
			}

		function generateRandomCircle() {
        c.x = generateRandomNum(50, 550);
        c.y = generateRandomNum(50, 350);
        c.r = generateRandomNum(20, 50);
        gc.beginPath();
        gc.strokeStyle = chooseRandomcolor();
        gc.arc(c.x,c.y,c.r,0,Math.PI*2,true);
        gc.lineWidth = 2;
        gc.stroke();
        circleArray.push(c)
		}
    function moveCircles() {
        circleArray.forEach(circle => {
          console.log(circle)
          circle.x -= 1;
          circle.y -= 1;
          gc.clearRect(0,0,cv.width,cv.height);
          gc.beginPath();
          gc.strokeStyle = circle.color;
          gc.arc(circle.x,circle.y,circle.r,0,Math.PI*2,true);
          gc.lineWidth = 2;
          gc.stroke();
        })
    }

	</script>
</body>
</html>